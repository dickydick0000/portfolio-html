<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Chaesa Kitchen - Premium Homemade</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --brand-primary: #78350f; --brand-secondary: #b45309; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; overscroll-behavior-y: contain; background-color: #f3f4f6; }
        .safe-area-top { padding-top: env(safe-area-inset-top); }
        .safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }
        .meat-gradient { background: linear-gradient(135deg, #78350f 0%, #b45309 100%); position: relative; }
        .kitchen-pattern { position: absolute; inset: 0; opacity: 0.12; background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='1' fill-rule='evenodd'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/svg%3E"); mask-image: linear-gradient(to bottom, black, transparent); }
        .ornament-layer { position: absolute; inset: 0; pointer-events: none; overflow: hidden; display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; padding: 10px; opacity: 0.15; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        [v-cloak] { display: none; }
        .card-shadow { box-shadow: 0 4px 20px -2px rgba(0,0,0,0.05); }
        .active-scale:active { transform: scale(0.96); transition: transform 0.1s; }
        .sheet-enter-active, .sheet-leave-active { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .sheet-enter-from, .sheet-leave-to { transform: translateY(100%); }
        .tab-active { background: var(--brand-primary); color: white; box-shadow: 0 4px 12px rgba(120, 53, 15, 0.2); }
        .nav-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
        .custom-select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2378350f'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.5rem center; background-size: 1rem; padding-right: 1.5rem; padding-left: 0.75rem; }
        @keyframes subtle-float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        .float-icon { animation: subtle-float 4s ease-in-out infinite; }
        input, select, textarea { font-size: 16px !important; }
        .admin-input { background: #fdf2f2; border: 1px solid #fed7d7; border-radius: 8px; padding: 4px 8px; font-weight: bold; color: #78350f; width: 100%; outline: none; }
        .admin-input:focus { border-color: #b45309; background: white; }
    </style>
</head>
<body class="bg-gray-100">

<div id="app" v-cloak class="max-w-md mx-auto min-h-screen bg-white relative flex flex-col shadow-2xl">
    
    <header class="meat-gradient px-6 pt-12 pb-8 rounded-b-[2.5rem] overflow-hidden shrink-0 safe-area-top">
        <div class="kitchen-pattern"></div>
        <div class="ornament-layer">
            <i class="fas fa-cookie float-icon text-white text-xl"></i>
            <i class="fas fa-utensils float-icon text-white text-lg"></i>
            <i class="fas fa-bread-slice float-icon text-white text-xl"></i>
            <i class="fas fa-blender float-icon text-white text-lg"></i>
        </div>

        <div class="flex justify-between items-start relative z-10">
            <div class="flex items-center gap-3">
                <div class="w-16 h-16 bg-white rounded-full p-0.5 shadow-xl border border-white/20 overflow-hidden flex items-center justify-center">
                    <img src="image/logo.png" class="w-full h-full object-contain" onerror="this.src='https://via.placeholder.com/100?text=LOGO'">
                </div>
                <div>
                    <h1 class="text-2xl font-extrabold tracking-tight text-white leading-none">Chaesa Kitchen</h1>
                    <p class="text-orange-200/80 text-[10px] uppercase font-bold tracking-[0.2em] mt-1">Premium Homemade Food</p>
                </div>
            </div>

            <div class="flex gap-2">
                <button @click="chatAdmin" class="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-md active-scale border border-white/10">
                    <i class="fab fa-whatsapp text-lg text-green-300"></i>
                </button>
                <button @click="toggleAdmin" class="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-md active-scale border border-white/10">
                    <i class="fas" :class="isLoggedIn ? 'fa-unlock text-orange-200' : 'fa-lock text-white'"></i>
                </button>
            </div>
        </div>

        <div class="mt-6 min-h-[60px] flex flex-col justify-center transition-all">
            <div class="bg-black/20 backdrop-blur-md p-3 rounded-2xl flex-1 border border-white/10 relative"
                 :class="[!config.showPromo && !isLoggedIn ? 'opacity-0 pointer-events-none' : 'opacity-100']">
                
                <div class="flex justify-between items-center mb-1">
                    <div class="flex items-center gap-1.5">
                        <i class="fas fa-tag text-[8px] text-orange-300"></i>
                        <p class="text-orange-200 text-[8px] font-black uppercase tracking-widest">Promo Hari Ini</p>
                    </div>
                    <div v-if="isLoggedIn" class="flex items-center cursor-pointer" @click="config.showPromo = !config.showPromo; saveToFirebase()">
                        <div class="relative w-6 h-3 rounded-full bg-white/20">
                            <div class="absolute left-0 w-3 h-3 transition transform bg-white rounded-full shadow" :class="config.showPromo ? 'translate-x-3 bg-green-400' : 'translate-x-0 bg-gray-400'"></div>
                        </div>
                    </div>
                </div>

                <div v-if="!isLoggedIn" class="text-white text-xs font-bold">{{ config.promoText }}</div>
                <input v-else type="text" v-model="config.promoText" @change="saveToFirebase"
                        class="bg-white/10 text-white text-xs font-bold w-full outline-none border-b border-white/30 py-1">
            </div>
        </div>
    </header>

    <nav class="sticky top-0 bg-white/95 backdrop-blur-md z-30 px-4 py-4 border-b border-gray-100 shrink-0">
        <div class="nav-grid">
            <button v-for="cat in categories"
                    @click="activeTab = cat"
                    :class="activeTab === cat ? 'tab-active' : 'bg-gray-50 text-gray-400'"
                    class="py-2.5 rounded-xl text-[9px] font-bold uppercase tracking-tighter transition-all active-scale text-center truncate">
                {{ cat }}
            </button>
        </div>
    </nav>

    <main class="flex-1 px-4 pt-4 pb-32 overflow-y-auto bg-gray-50/50 relative">
        <div v-if="loading" class="absolute inset-0 bg-white/80 backdrop-blur-sm z-50 flex flex-col items-center justify-center">
            <div class="w-10 h-10 border-4 border-amber-900 border-t-transparent rounded-full animate-spin mb-2"></div>
            <p class="text-[10px] font-bold text-amber-900 uppercase tracking-widest">Sinkronisasi Firebase...</p>
        </div>

        <div v-if="showLogin" class="mb-6 p-6 bg-white rounded-3xl border border-orange-100 shadow-sm">
            <h3 class="text-xs font-black text-amber-900 uppercase mb-4 text-center">Admin Verification</h3>
            <input type="password" v-model="passInput" @keyup.enter="login" placeholder="Pin Akses"
                    class="w-full p-4 rounded-2xl bg-gray-50 border-none text-center font-bold tracking-widest outline-none focus:ring-2 focus:ring-amber-800">
            <button @click="login" class="w-full mt-3 bg-amber-900 text-white py-4 rounded-2xl font-bold text-xs uppercase active-scale">Akses Sekarang</button>
        </div>

        <div class="space-y-4">
            <div v-for="(item, index) in filteredProducts" :key="index"
                 class="bg-white p-4 rounded-3xl border border-gray-100 card-shadow flex items-start gap-4 transition-all"
                 :class="{'opacity-60': item.stock <= 0 && !isLoggedIn}">
                
                <div :class="getIconBg(item.name)" class="w-14 h-14 rounded-2xl flex items-center justify-center shrink-0 shadow-inner mt-1">
                    <i class="fas text-xl" :class="[getIcon(item.name), getIconColor(item.name)]"></i>
                </div>

                <div class="flex-1 min-w-0">
                    <template v-if="!isLoggedIn">
                        <h4 class="font-bold text-gray-800 text-[14px] leading-tight mb-1 truncate">{{ item.name }}</h4>
                        <div class="flex items-center gap-1.5 mb-1">
                            <span class="w-1.5 h-1.5 rounded-full" :class="item.stock > 0 ? 'bg-green-500' : 'bg-red-500'"></span>
                            <span class="text-[10px] font-bold uppercase tracking-wider text-gray-400">
                                {{ item.stock }} {{ item.unit }} Tersedia
                            </span>
                        </div>
                        <div class="text-amber-900 font-extrabold text-lg">
                            <span class="text-[10px] font-bold mr-0.5 opacity-50">Rp</span>{{ item.price.toLocaleString() }}
                        </div>
                    </template>

                    <template v-else>
                        <div class="space-y-2">
                            <div>
                                <label class="text-[8px] font-bold uppercase text-gray-400">Nama Produk</label>
                                <input type="text" v-model="item.name" @change="saveToFirebase" class="admin-input text-xs">
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <label class="text-[8px] font-bold uppercase text-gray-400">Harga (Rp)</label>
                                    <input type="number" v-model.number="item.price" @change="saveToFirebase" class="admin-input text-xs">
                                </div>
                                <div>
                                    <label class="text-[8px] font-bold uppercase text-gray-400">Stok</label>
                                    <input type="number" v-model.number="item.stock" @change="saveToFirebase" class="admin-input text-xs">
                                </div>
