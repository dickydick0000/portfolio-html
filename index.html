<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Chaesa Kitchen - Premium Homemade</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --brand-primary: #78350f; --brand-secondary: #b45309; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; overscroll-behavior-y: contain; background-color: #f3f4f6; }
        .safe-area-top { padding-top: env(safe-area-inset-top); }
        .meat-gradient { background: linear-gradient(135deg, #78350f 0%, #b45309 100%); position: relative; }
        .kitchen-pattern { position: absolute; inset: 0; opacity: 0.12; background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z' fill='%23ffffff'/%3E%3C/svg%3E"); mask-image: linear-gradient(to bottom, black, transparent); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        [v-cloak] { display: none; }
        .card-shadow { box-shadow: 0 4px 20px -2px rgba(0,0,0,0.05); }
        .active-scale:active { transform: scale(0.96); transition: transform 0.1s; }
        .tab-active { background: var(--brand-primary); color: white; box-shadow: 0 4px 12px rgba(120, 53, 15, 0.2); }
        .admin-input { background: #fdf2f2; border: 1px solid #fed7d7; border-radius: 8px; padding: 4px 8px; font-weight: bold; color: #78350f; width: 100%; outline: none; }
        input, select, textarea { font-size: 16px !important; }
    </style>
</head>
<body class="bg-gray-100">

<div id="app" v-cloak class="max-w-md mx-auto min-h-screen bg-white relative flex flex-col shadow-2xl">
    
    <header class="meat-gradient px-6 pt-12 pb-8 rounded-b-[2.5rem] overflow-hidden shrink-0 safe-area-top">
        <div class="kitchen-pattern"></div>
        <div class="flex justify-between items-start relative z-10">
            <div class="flex items-center gap-3">
                <div class="w-16 h-16 bg-white rounded-full p-0.5 shadow-xl flex items-center justify-center overflow-hidden">
                    <img src="image/logo.png" class="w-full h-full object-contain" onerror="this.src='https://via.placeholder.com/100?text=LOGO'">
                </div>
                <div>
                    <h1 class="text-2xl font-extrabold text-white leading-none">Chaesa Kitchen</h1>
                    <p class="text-orange-200/80 text-[10px] uppercase font-bold tracking-widest mt-1">Premium Homemade Food</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button @click="chatAdmin" class="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-md active-scale border border-white/10">
                    <i class="fab fa-whatsapp text-lg text-green-300"></i>
                </button>
                <button @click="toggleAdmin" class="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-md active-scale border border-white/10">
                    <i class="fas" :class="isLoggedIn ? 'fa-unlock text-orange-200' : 'fa-lock text-white'"></i>
                </button>
            </div>
        </div>

        <div class="mt-6 min-h-[60px] flex flex-col justify-center">
            <div v-if="config.showPromo || isLoggedIn" class="bg-black/20 backdrop-blur-md p-3 rounded-2xl border border-white/10">
                <div class="flex justify-between items-center mb-1">
                    <p class="text-orange-200 text-[8px] font-black uppercase tracking-widest">Promo Hari Ini</p>
                    <div v-if="isLoggedIn" @click="config.showPromo = !config.showPromo; saveData()" class="cursor-pointer">
                        <i class="fas fa-power-off text-[10px]" :class="config.showPromo ? 'text-green-400' : 'text-gray-400'"></i>
                    </div>
                </div>
                <div v-if="!isLoggedIn" class="text-white text-xs font-bold">{{ config.promoText }}</div>
                <input v-else type="text" v-model="config.promoText" @change="saveData" class="bg-transparent text-white text-xs font-bold w-full outline-none border-b border-white/30">
            </div>
        </div>
    </header>

    <nav class="sticky top-0 bg-white/95 backdrop-blur-md z-30 px-4 py-4 border-b border-gray-100 flex gap-2 overflow-x-auto no-scrollbar">
        <button v-for="cat in categories" @click="activeTab = cat" :class="activeTab === cat ? 'tab-active' : 'bg-gray-50 text-gray-400'"
                class="px-5 py-2.5 rounded-xl text-[9px] font-bold uppercase whitespace-nowrap transition-all active-scale">
            {{ cat }}
        </button>
    </nav>

    <main class="flex-1 px-4 pt-4 pb-32 overflow-y-auto bg-gray-50/50 relative">
        <div v-if="loading" class="flex flex-col items-center mt-20">
            <div class="w-10 h-10 border-4 border-amber-900 border-t-transparent rounded-full animate-spin mb-2"></div>
            <p class="text-[10px] font-bold text-amber-900 uppercase">Menghubungkan Database...</p>
        </div>

        <div v-if="showLogin" class="mb-6 p-6 bg-white rounded-3xl border border-orange-100 shadow-sm">
            <input type="password" v-model="passInput" @keyup.enter="login" placeholder="Pin Akses" class="w-full p-4 rounded-2xl bg-gray-50 border-none text-center font-bold outline-none focus:ring-2 focus:ring-amber-800">
            <button @click="login" class="w-full mt-3 bg-amber-900 text-white py-4 rounded-2xl font-bold text-xs uppercase active-scale">Akses Sekarang</button>
        </div>

        <div class="space-y-4">
            <div v-for="(item, index) in filteredProducts" :key="index" class="bg-white p-4 rounded-3xl border border-gray-100 card-shadow flex items-start gap-4">
                <div class="w-14 h-14 bg-orange-50 rounded-2xl flex items-center justify-center shrink-0">
                    <i class="fas text-xl text-orange-600" :class="getIcon(item.name)"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <template v-if="!isLoggedIn">
                        <h4 class="font-bold text-gray-800 text-sm truncate">{{ item.name }}</h4>
                        <p class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">{{ item.stock }} {{ item.unit }} Tersedia</p>
                        <div class="text-amber-900 font-extrabold text-lg">Rp {{ item.price.toLocaleString() }}</div>
                    </template>
                    <template v-else>
                        <input type="text" v-model="item.name" @change="saveData" class="admin-input text-xs mb-1">
                        <div class="grid grid-cols-2 gap-2">
                            <input type="number" v-model.number="item.price" @change="saveData" class="admin-input text-xs" placeholder="Harga">
                            <input type="number" v-model.number="item.stock" @change="saveData" class="admin-input text-xs" placeholder="Stok">
                        </div>
                    </template>
                </div>
                <div class="shrink-0">
                    <div v-if="!isLoggedIn">
                        <select v-if="item.stock > 0" @change="setQtyFromSelect(item, $event)" class="bg-orange-50 text-amber-900 h-10 w-16 rounded-xl font-black text-sm outline-none">
                            <option value="0">0</option>
                            <option v-for="n in Math.min(item.stock, 10)" :value="n">{{ n }}</option>
                        </select>
                        <span v-else class="text-[9px] font-bold text-red-400 px-3 py-2 bg-red-50 rounded-lg uppercase">Habis</span>
                    </div>
                    <button v-else @click="removeProduct(index)" class="w-10 h-10 bg-red-50 text-red-400 rounded-xl"><i class="fas fa-trash-alt"></i></button>
                </div>
            </div>
        </div>
        <button v-if="isLoggedIn" @click="addProduct" class="w-full mt-6 py-4 border-2 border-dashed border-gray-200 rounded-3xl text-gray-400 font-bold text-xs uppercase">+ Tambah Menu Baru</button>
    </main>

    <div v-if="cartTotal > 0 && !showCart" @click="showCart = true" class="fixed bottom-6 left-4 right-4 bg-amber-900 text-white p-2 rounded-2xl flex items-center z-40 max-w-[392px] mx-auto">
        <div class="bg-orange-500 w-12 h-12 rounded-full flex items-center justify-center text-xl shrink-0"><i class="fas fa-shopping-cart"></i></div>
        <div class="ml-4 flex-1">
            <p class="text-[9px] font-bold text-orange-200 uppercase mb-1">{{ cartTotal }} Item</p>
            <p class="text-sm font-black">Rp {{ totalPrice.toLocaleString() }}</p>
        </div>
        <div class="bg-white/10 px-6 py-3 rounded-full text-[10px] font-black uppercase">Lanjut <i class="fas fa-arrow-right"></i></div>
    </div>

    <div v-if="showCart" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex flex-col justify-end">
        <div class="absolute inset-0" @click="showCart = false"></div>
        <div class="bg-white rounded-t-[3rem] p-8 max-w-md mx-auto w-full relative">
            <h2 class="text-xl font-black mb-6">Detail Pesanan</h2>
            <div class="space-y-3 mb-6">
                <input v-model="form.name" type="text" placeholder="Nama" class="w-full bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                <input v-model="form.phone" type="tel" placeholder="No WhatsApp" class="w-full bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                <textarea v-model="form.address" placeholder="Alamat Lengkap" class="w-full bg-gray-50 p-4 rounded-2xl outline-none font-bold h-24"></textarea>
            </div>
            <button @click="checkout" class="w-full bg-amber-900 text-white py-5 rounded-2xl font-black shadow-xl">PESAN VIA WHATSAPP</button>
        </div>
    </div>
</div>

<script>
// --- KONFIGURASI FIREBASE ---
// Masukkan data dari Firebase Console -> Project Settings -> General -> Your Apps
const firebaseConfig = {
    apiKey: "GANTI_DENGAN_API_KEY_ANDA",
    authDomain: "chaesa-kitchen.firebaseapp.com",
    databaseURL: "GANTI_DENGAN_DATABASE_URL_ANDA",
    projectId: "chaesa-kitchen",
    storageBucket: "chaesa-kitchen.appspot.com",
    messagingSenderId: "...",
    appId: "..."
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const { createApp } = Vue;

createApp({
    data() {
        return {
            loading: true, isLoggedIn: false, showLogin: false, showCart: false,
            passInput: '', activeTab: 'semua',
            categories: ['semua', 'risol', 'brownies', 'lain lain'],
            form: { name: '', phone: '', address: '', note: '' },
            cart: [], products: [],
            config: { promoText: 'Memuat promo...', showPromo: true },
            waNumber: '6285385978915'
        }
    },
    computed: {
        filteredProducts() {
            if (this.activeTab === 'semua') return this.products;
            return this.products.filter(p => p.category === this.activeTab);
        },
        cartTotal() { return this.cart.
